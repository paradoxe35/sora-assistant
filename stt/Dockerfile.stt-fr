FROM alphacep/kaldi-vosk-server:latest

ENV MODEL_VERSION 0.6

ENV LINTO_VERSION 2.2.0

RUN mkdir /opt/vosk-model-fr \
   && cd /opt/vosk-model-fr \
   && wget -q https://alphacephei.com/vosk/models/vosk-model-fr-${MODEL_VERSION}-linto-${LINTO_VERSION}.zip \
   && unzip vosk-model-fr-${MODEL_VERSION}-linto-${LINTO_VERSION}.zip \
   && mv vosk-model-fr-${MODEL_VERSION}-linto-${LINTO_VERSION} model \
   && rm vosk-model-fr-${MODEL_VERSION}-linto-${LINTO_VERSION}.zip

# COPY requirements.txt requirements.txt

# RUN pip3 install -r requirements.txt

EXPOSE 2700

WORKDIR /opt/vosk-server/websocket

COPY . .

ENV VOSK_SAMPLE_RATE 16000

CMD [ "python3", "./asr_server.py", "/opt/vosk-model-fr/model" ]